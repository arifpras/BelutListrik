"0","pos <- ""GK"""
"0","prop <- 0.5"
"0",""
"0","#main player"
"0","gk_maxpoints <- db01c %>%"
"0","  group_by(position) %>%"
"0","  arrange(desc(avg_points)) %>%"
"0","  slice_head(prop = prop) %>%"
"0","  ungroup() %>%"
"0","  filter(position == pos)"
"0",""
"0","#bench player"
"0","gk_minprice <- db01c %>%"
"0","  group_by(position) %>%"
"0","  arrange(avg_price) %>%"
"0","  slice_head(prop = prop) %>%"
"0","  ungroup() %>%"
"0","  filter(position == pos)"
"0",""
"0","#all players"
"0","gk_pool <- gk_maxpoints %>%"
"0","  bind_rows(gk_minprice) %>%"
"0","  unique()"
"0",""
"0","db03a <- t(combn(gk_pool$Understat_Name, 2)) #max: 2 players"
"0","#saveRDS(db03a, ""db03a.rds"")"
"0",""
"0","db03b <- db03a %>%"
"0","  na.omit() %>%"
"0","  as_tibble() %>%"
"0","  mutate(""id_gk"" = row_number()) %>%"
"0","  relocate(id_gk) %>%"
"0","  pivot_longer(cols = 2:3,"
"0","               names_to = ""v"","
"0","               values_to = ""Understat_Name"") %>%"
"0","  select(-v) %>%"
"0","  left_join(db01c, by = ""Understat_Name"")"
"2","Warning:"
"2"," The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
Using compatibility `.name_repair`.
[90mThis warning is displayed once every 8 hours.[39m
[90mCall `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.[39m
"
"0","#saveRDS(db03b, ""db03b.rds"")"
"0",""
"0","#db03c <- db03b %>%"
"0","#  group_by(id_gk) %>%"
"0","#  mutate("
"0","#    agg_avgpoints = sum(avg_points),"
"0","#    avg_wvgpoints = mean(wvg_points),"
"0","#    avg_avgminutes = mean(avg_minutes),"
"0","#    avg_stdpoints = mean(std_points),"
"0","#    agg_avgprice = sum(avg_price),"
"0","#    avg_stdinfluence = mean(std_influence),"
"0","#    avg_avgXG = mean(avg_xG),"
"0","#    avg_avgxA = mean(avg_xA),"
"0","#    avg_avgnpxG = mean(avg_npxG),"
"0","#    avg_avgxGChain = mean(avg_xGChain),"
"0","#    avg_avgxGBuildup = mean(avg_xGBuildup)"
"0","#  ) %>%"
"0","#  arrange("
"0","#    desc(agg_avgpoints),"
"0","#    desc(avg_wvgpoints), #semakin besar, semakin worth it"
"0","#    agg_avgprice,"
"0","#    desc(avg_avgXG),"
"0","#    desc(avg_avgxA),"
"0","#    desc(avg_avgminutes),"
"0","#    desc(avg_stdpoints)"
"0","#  )"
"0",""
"0","db03c <- db03b %>%"
"0","  group_by(id_gk) %>%"
"0","  summarise("
"0","    agg_avgpoints = sum(avg_points),"
"0","    avg_wvgpoints = mean(wvg_points),"
"0","    avg_avgminutes = mean(avg_minutes),"
"0","    avg_stdpoints = mean(std_points),"
"0","    agg_avgprice = sum(avg_price),"
"0","    avg_wvgprice = mean(wvg_price),"
"0","    avg_stdinfluence = mean(std_influence),"
"0","    avg_avgXG = mean(avg_xG),"
"0","    avg_avgxA = mean(avg_xA),"
"0","    avg_avgnpxG = mean(avg_npxG),"
"0","    avg_avgxGChain = mean(avg_xGChain),"
"0","    avg_avgxGBuildup = mean(avg_xGBuildup)"
"0","    ) %>%"
"0","  arrange("
"0","    desc(agg_avgpoints),"
"0","    desc(avg_wvgpoints), #semakin besar, semakin worth it"
"0","    agg_avgprice,"
"0","    desc(avg_avgXG),"
"0","    desc(avg_avgxA),"
"0","    desc(avg_avgminutes),"
"0","    desc(avg_stdpoints)"
"0","  )"
"0",""
"0","#saveRDS(db03c, ""db03c.rds"")"
"0","  "
"0","#db99c <- db03c %>%"
"0","#  filter(between(total_avgpoints,"
"0","#                 quantile(total_avgpoints, .25),"
"0","#                 quantile(total_avgpoints, .75))"
"0","#         )"
"0",""
"0","db03d <- db03c %>%"
"0","  arrange(desc(agg_avgpoints)) %>%"
"0","  filter(agg_avgprice < 10 & agg_avgprice > 8) %>%"
"0","  slice_head(n = 5) %>%"
"0","  left_join(db03b, by = ""id_gk"") %>%"
"0","  relocate(id_gk, Understat_Name, team) %>%"
"0","  select("
"0","    id_gk,"
"0","    Understat_Name,"
"0","    team,"
"0","    avg_points,"
"0","    std_points,"
"0","    wvg_points,"
"0","    avg_price,"
"0","    wvg_price,"
"0","    avg_xG,"
"0","    avg_xA,"
"0","    avg_xGChain,"
"0","    avg_xGBuildup,"
"0","    agg_avgprice,"
"0","    agg_avgpoints,"
"0","    avg_stdpoints,"
"0","    avg_wvgpoints,"
"0","    avg_wvgprice,"
"0","    avg_avgXG,"
"0","    avg_avgxA,"
"0","    avg_avgxGChain,"
"0","    avg_avgxGBuildup"
"0","  ) %>%"
"0","  arrange(desc(agg_avgpoints),"
"0","          desc(avg_wvgpoints))"
"0",""
"0","("
"0","  gk_plot <- db03d %>%"
"0","    select("
"0","      id_gk,"
"0","      agg_avgprice,"
"0","      agg_avgpoints,"
"0","      avg_avgxGChain,"
"0","      avg_avgxGBuildup"
"0","    ) %>%"
"0","    group_by(id_gk) %>%"
"0","    slice_head(n = 1) %>%"
"0","    ungroup() %>%"
"0","    pivot_longer("
"0","      cols = 2:5,"
"0","      names_to = ""indicator"","
"0","      values_to = ""value"""
"0","    ) %>%"
"0","    ggplot(aes("
"0","      x = reorder_within(id_gk, value, indicator),"
"0","      y = value,"
"0","      fill = factor(id_gk)"
"0","    )) +"
"0","    geom_col() +"
"0","    #geom_bar(stat = ""identity"", aes(fill = factor(id_gk))) +"
"0","    coord_flip() +"
"0","    scale_x_reordered() +"
"0","    #scale_fill_viridis(discrete = TRUE) +"
"0","    #scale_fill_manual(values = wes_palette(""Darjeeling1"")) +"
"0","    scale_fill_manual(values = c("
"0","      ""#ef476f"", ""#ffd166"", ""#06d6a0"", ""#118ab2"", ""#073b4c"""
"0","    )) +"
"0","    egg::theme_article() +"
"0","    facet_wrap( ~ indicator, ncol = 2, scales = ""free"") +"
"0","    theme(legend.position = ""none"") +"
"0","    labs(x = """","
"0","         y = """")"
"0",")"
